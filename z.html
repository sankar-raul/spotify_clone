<!DOCTYPE html>
<html>
<head>
<title>Document Picture-in-Picture for H1</title>
<style>

  h1 {
    background-color: #000;
  }
</style>
</head>
<body>

<h1>This is an H1 heading that will go into PiP</h1>
<div class="mini-player">

</div>

<button id="pip-button">Toggle H1 in Picture-in-Picture</button>

<script>
const pipButton = document.getElementById('pip-button');
const h1Element = document.querySelector('h1');

if ('documentPictureInPicture' in window) {
  pipButton.addEventListener('click', async () => {
    try {
      if (document.pictureInPictureElement) {
        document.exitPictureInPicture();
      } else {
        await documentPictureInPicture.requestWindow({ width: 400, height: 100 });

        // Create a container element inside the PiP window
        const pipContainer = document.createElement('div');
        pipContainer.id = 'pip-container'; // Give it an ID for styling if needed
        // pipContainer.style.background = "#000";
        // Append the h1 to the container
        // h1Element.style.color = "#FFF"
        const link = document.createElement('link')
        link.rel = "stylesheet"
        link.href = './z.css'
        pipContainer.appendChild(h1Element);
        // documentPictureInPicture.window.document.body.style.background = "#000"
        // Append the container to the PiP window
        documentPictureInPicture.window.document.head.appendChild(link)
        documentPictureInPicture.window.document.body.appendChild(pipContainer);
      }
    } catch (error) {
      console.error('Error entering Picture-in-Picture:', error);
    }
  });

  document.addEventListener("leavepictureinpicture", () => {
    //Important: get the element from the pip window before appending

    const pipContainer = documentPictureInPicture.window.document.getElementById('pip-container');
    if (pipContainer){
        document.body.appendChild(pipContainer.firstChild); // Re-append the H1
    }
  });
} else {
  pipButton.disabled = true;
  pipButton.textContent = 'Document Picture-in-Picture not supported';
}
</script>

</body>
</html>